"use strict";(()=>{var e={};e.id=280,e.ids=[280],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},1282:e=>{e.exports=require("child_process")},4770:e=>{e.exports=require("crypto")},2048:e=>{e.exports=require("fs")},629:e=>{e.exports=require("fs/promises")},2615:e=>{e.exports=require("http")},2694:e=>{e.exports=require("http2")},5240:e=>{e.exports=require("https")},9801:e=>{e.exports=require("os")},5315:e=>{e.exports=require("path")},5816:e=>{e.exports=require("process")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},4492:e=>{e.exports=require("node:stream")},2849:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m});var o={};t.r(o),t.d(o,{GET:()=>c,dynamic:()=>p});var s=t(3278),n=t(5002),a=t(4877),i=t(1309),u=t(8699);let p="force-dynamic";async function c(e){try{let r=e.nextUrl.searchParams,t=r.get("matricule"),o=Number.parseInt(r.get("year")||"2025"),s=r.get("examType")||"BAC",n=r.get("sessionType")||void 0;if(!t)return i.NextResponse.json({error:"Matricule is required"},{status:400});let a="true"===r.get("directClick");if("CONCOURS"===s&&!a)return i.NextResponse.json({error:"Recherche par matricule non disponible pour les examens CONCOURS. Utilisez la recherche par nom ou \xe9tablissement.",code:"SEARCH_NOT_SUPPORTED"},{status:400});if(console.log(`🔍 Searching for matricule: ${t} in ${s} ${o}${n?` (${n})`:""}`),"BAC"===s&&!n)return i.NextResponse.json({error:"Session type is required for BAC exams. Please specify either 'NORMALE' or 'COMPLEMENTAIRE'",code:"SESSION_REQUIRED"},{status:400});try{let p;if("CONCOURS"===s&&a){let t=r.get("schoolName"),n=r.get("studentName"),a=r.get("wilaya"),c=r.get("moughataa");if(!t){let r=e.headers.get("referer");r&&(t=new URL(r).searchParams.get("name"))}if(t&&(t=decodeURIComponent(t)),n&&(n=decodeURIComponent(n)),a&&(a=decodeURIComponent(a)),c&&(c=decodeURIComponent(c)),console.log(`🔍 CONCOURS location search: studentName=${n}, wilaya=${a}, moughataa=${c}, schoolName=${t}`),n&&a&&c&&t)p=await u.VT.findStudentByNameAndLocation(n,a,c,t,o,s);else if(a&&c&&t)p=await u.VT.findStudentByLocation(a,c,t,o,s);else{if(!t||!n)return console.log(`❌ CONCOURS: Insufficient location data for unique identification`),i.NextResponse.json({error:"\xc9tudiant non trouv\xe9 - donn\xe9es de localisation insuffisantes"},{status:404});p=await u.VT.findStudentByNameAndSchool(n,o,s,t,a)}}else p=await u.VT.findStudentByMatricule(t,o,s,n,a);if(!p)return console.log(`❌ Student with matricule ${t} not found in ${s} ${o}${n?` (${n})`:""}`),i.NextResponse.json({error:"\xc9tudiant non trouv\xe9"},{status:404});return console.log(`✅ Found student: ${p.nom_complet} (${t}) in ${s} ${o}${n?` (${n})`:""}`),i.NextResponse.json(p)}catch(e){if(e instanceof Error&&"Session type is required for BAC exams"===e.message)return i.NextResponse.json({error:"Session type is required for BAC exams. Please specify either 'NORMALE' or 'COMPLEMENTAIRE'",code:"SESSION_REQUIRED"},{status:400});throw e}}catch(e){return console.error("\uD83D\uDCA5 Search error:",e),i.NextResponse.json({error:"Internal server error",timestamp:new Date().toISOString()},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/search/route",pathname:"/api/search",filename:"route",bundlePath:"app/api/search/route"},resolvedPagePath:"D:\\WORK\\FREELANCER\\student-result-upgraded\\app\\api\\search\\route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:f}=d,h="/api/search/route";function x(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[9379,4833,2362,8699],()=>t(2849));module.exports=o})();
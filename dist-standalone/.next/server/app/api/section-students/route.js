"use strict";(()=>{var e={};e.id=8994,e.ids=[8994],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6086:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>y,patchFetch:()=>g,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var n={};s.r(n),s.d(n,{GET:()=>c});var a=s(3278),r=s(5002),o=s(4877),i=s(1309);let u=new(s(3524)).PrismaClient;async function c(e){try{let{searchParams:t}=new URL(e.url),s=parseInt(t.get("year")||"2025"),n=t.get("examType")||"BAC",a=t.get("section"),r=t.get("wilaya"),o=t.get("sessionType"),c=t.get("sortBy")||"moyenne",l=t.get("order")||"desc",p=parseInt(t.get("limit")||"100");if(!a&&"BAC"===n)return i.NextResponse.json({error:"Section is required for BAC exams"},{status:400});let d={year:s,examType:n};a&&(d.section=a),r&&(d.wilaya=r),"BAC"===n&&o&&(d.sessionType=o);let m=await u.student.findMany({where:d,orderBy:{[c]:l},take:p,select:{id:!0,matricule:!0,nom_complet:!0,ecole:!0,etablissement:!0,moyenne:!0,rang:!0,admis:!0,decision_text:!0,section:!0,wilaya:!0,lieu_nais:!0,date_naiss:!0}}),y={year:s,examType:n};"BAC"===n&&o&&(y.sessionType=o);let g=(await u.student.groupBy({by:["section"],where:y,_count:{_all:!0},_sum:{moyenne:!0},_avg:{moyenne:!0}})).map(e=>({name:e.section,total:e._count._all||0,admitted:0,successRate:0,averageScore:e._avg.moyenne||0})),_=(await u.student.groupBy({by:["wilaya"],where:{...d},_count:{_all:!0},_sum:{moyenne:!0},_avg:{moyenne:!0}})).filter(e=>e.wilaya).map(e=>({name:e.wilaya,total:e._count._all||0,admitted:0,successRate:0,averageScore:e._avg.moyenne||0})).sort((e,t)=>t.averageScore-e.averageScore);return i.NextResponse.json({success:!0,students:m,sectionStatistics:g,wilayaStatistics:_,filters:{year:s,examType:n,section:a,wilaya:r,sortBy:c,order:l,limit:p}})}catch(e){return console.error("Error fetching section students:",e),i.NextResponse.json({error:"Failed to fetch section students"},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/section-students/route",pathname:"/api/section-students",filename:"route",bundlePath:"app/api/section-students/route"},resolvedPagePath:"D:\\WORK\\FREELANCER\\student-result-upgraded\\app\\api\\section-students\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:m}=l,y="/api/section-students/route";function g(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),n=t.X(0,[9379,4833],()=>s(6086));module.exports=n})();